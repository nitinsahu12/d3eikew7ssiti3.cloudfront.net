<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Quiz Admin Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
* {
  box-sizing: border-box;
  font-family: "Segoe UI", sans-serif;
}

body {
  margin: 0;
  min-height: 100vh;
  background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
  display: flex;
  color: #fff;
}

/* SIDEBAR */
.sidebar {
  width: 260px;
  background: rgba(255,255,255,0.08);
  backdrop-filter: blur(15px);
  padding: 25px 20px;
}

.sidebar h2 {
  text-align: center;
  margin-bottom: 30px;
}

.sidebar button {
  width: 100%;
  padding: 14px;
  margin-bottom: 12px;
  border-radius: 12px;
  border: none;
  cursor: pointer;
  background: linear-gradient(135deg, #00c6ff, #0072ff);
  color: #fff;
  font-size: 15px;
}

/* MAIN */
.main {
  flex: 1;
  padding: 30px;
}

.header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 25px;
}

.logout {
  padding: 10px 18px;
  border-radius: 10px;
  border: none;
  cursor: pointer;
  background: linear-gradient(135deg, #ff512f, #dd2476);
  color: #fff;
}

/* FORM */
.form-box {
  background: rgba(255,255,255,0.15);
  border-radius: 16px;
  padding: 25px;
  max-width: 700px;
  margin-bottom: 30px;
}

.form-group {
  margin-bottom: 12px;
}

input, textarea, select {
  width: 100%;
  padding: 12px;
  border-radius: 8px;
  border: none;
}

textarea {
  resize: none;
  height: 80px;
}

.add-btn {
  padding: 14px;
  width: 100%;
  border-radius: 10px;
  border: none;
  cursor: pointer;
  background: linear-gradient(135deg, #11998e, #38ef7d);
  font-size: 16px;
  font-weight: bold;
}

#status {
  margin-top: 10px;
  font-weight: bold;
}

/* TABLE */
table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 20px;
}

th, td {
  padding: 12px;
  border-bottom: 1px solid rgba(255,255,255,0.2);
}

th {
  text-align: left;
}

.delete-btn {
  padding: 6px 12px;
  border-radius: 8px;
  border: none;
  cursor: pointer;
  background: #d9534f;
  color: #fff;
}
</style>
</head>

<body>

<!-- SIDEBAR -->
<div class="sidebar">
  <h2>Admin Panel</h2>
  <button onclick="showSection('add')">Add Question</button>
  <button onclick="showSection('manage')">Manage Questions</button>
</div>

<!-- MAIN -->
<div class="main">

<div class="header">
  <h1 id="title">Add Question</h1>
  <button class="logout" onclick="logout()">Logout</button>
</div>

<!-- ADD QUESTION -->
<div id="add">
  <div class="form-box">
    <h2>Add New Question</h2>

    <div class="form-group">
      <textarea id="question" placeholder="Enter question"></textarea>
    </div>

    <div class="form-group"><input id="opt1" placeholder="Option A"></div>
    <div class="form-group"><input id="opt2" placeholder="Option B"></div>
    <div class="form-group"><input id="opt3" placeholder="Option C"></div>
    <div class="form-group"><input id="opt4" placeholder="Option D"></div>

    <div class="form-group">
      <select id="answer">
        <option value="">Correct Answer</option>
        <option value="0">A</option>
        <option value="1">B</option>
        <option value="2">C</option>
        <option value="3">D</option>
      </select>
    </div>

    <button class="add-btn" onclick="addQuestion()">Add Question</button>
    <div id="status"></div>
  </div>
</div>

<!-- MANAGE QUESTIONS -->
<div id="manage" style="display:none">
  <h2>All Questions</h2>

  <table>
    <thead>
      <tr>
        <th>Question</th>
        <th>Answer</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody id="list"></tbody>
  </table>
</div>

</div>

<script>
/* ===== CONFIG ===== */
const API_BASE =
  "https://fc6p2id6ed.execute-api.ap-south-1.amazonaws.com/prod";

/* ===== UI ===== */
function showSection(id) {
  document.getElementById("add").style.display = "none";
  document.getElementById("manage").style.display = "none";
  document.getElementById(id).style.display = "block";
  document.getElementById("title").innerText =
    id === "add" ? "Add Question" : "Manage Questions";

  if (id === "manage") loadQuestions();
}

function logout() {
  location.href = "index.html";
}

/* ===== API CALLS ===== */

async function addQuestion() {
  const q = question.value.trim();
  const options = [opt1.value, opt2.value, opt3.value, opt4.value];
  const ans = answer.value;
  const status = document.getElementById("status");

  if (!q || options.some(o => !o) || ans === "") {
    status.innerText = "Fill all fields ❌";
    return;
  }

  try {
    const res = await fetch(`${API_BASE}/questions`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        question: q,
        options,
        answer: Number(ans)
      })
    });

    const data = await res.json();
    if (!res.ok) throw new Error();

    status.innerText = "Question added successfully ✅";

    question.value = opt1.value = opt2.value = opt3.value = opt4.value = "";
    answer.value = "";

  } catch {
    status.innerText = "Error adding question ❌";
  }
}

async function loadQuestions() {
  const res = await fetch(`${API_BASE}/questions`);
  const data = await res.json();

  const list = document.getElementById("list");
  list.innerHTML = "";

  if (data.length === 0) {
    list.innerHTML = "<tr><td colspan='3'>No questions found</td></tr>";
    return;
  }

  data.forEach(q => {
    list.innerHTML += `
      <tr>
        <td>${q.question}</td>
        <td>${q.options[q.answer]}</td>
        <td>
          <button class="delete-btn"
            onclick="deleteQuestion('${q.questionId}')">
            Delete
          </button>
        </td>
      </tr>`;
  });
}

async function deleteQuestion(id) {
  if (!confirm("Delete this question?")) return;

  await fetch(`${API_BASE}/questions/${id}`, {
    method: "DELETE"
  });

  loadQuestions();
}
</script>

</body>
</html>
